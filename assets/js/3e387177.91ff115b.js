"use strict";(self.webpackChunkosmono_internal=self.webpackChunkosmono_internal||[]).push([[8824],{1112:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var s=t(5893),i=t(1151);const r={sidebar_position:5},o="Nammu - RMM Agent",a={id:"nammu/index",title:"Nammu - RMM Agent",description:"Program Flow",source:"@site/docs/nammu/index.md",sourceDirName:"nammu",slug:"/nammu/",permalink:"/docs/nammu/",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/nammu/index.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",next:{title:"Remote Configuration",permalink:"/docs/nammu/config"}},d={},l=[{value:"Program Flow",id:"program-flow",level:2},{value:"TODOs",id:"todos",level:2},{value:"Jobs",id:"jobs",level:2},{value:"Identifying Servers",id:"identifying-servers",level:2},{value:"Communication",id:"communication",level:2},{value:"Event Log",id:"event-log",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",mermaid:"mermaid",p:"p",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"nammu---rmm-agent",children:"Nammu - RMM Agent"}),"\n",(0,s.jsx)(n.h2,{id:"program-flow",children:"Program Flow"}),"\n",(0,s.jsx)(n.mermaid,{value:"flowchart TD\n    A[Nammu] --\x3eB(Installer)\n    A[Nammu] --\x3eC(Service Loop)\n    C --\x3e SA(Check Job Queue from API)\n    C --\x3e SB(Check Logs)\n    C --\x3e SC(Check Events)\n\n    SB --\x3e SBA(Collect new)\n\n    SC --\x3e SCA(If critical send to API immediately)\n    SC --\x3e SCB(Collect new)\n\n    SCB --\x3e STSA(Compress and send to server)\n    SBA --\x3e STSA(Compress and send to server)"}),"\n",(0,s.jsx)(n.h2,{id:"todos",children:"TODOs"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"import config from file"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"config dictates where to download further config from (just write in this, we dont know what furhter config stuff we want yet!)"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Windows service detection"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Checking over what logs/events that tacticalRMM tracks."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Tracking update status"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Deploying powershell scripts"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"jobs",children:"Jobs"}),"\n",(0,s.jsxs)(n.p,{children:["Create NATs channel per-organization: ",(0,s.jsx)(n.code,{children:"nammu-{orgid}-jobs"})]}),"\n",(0,s.jsx)(n.p,{children:"We then dictate jobs, specifying the agentId in the json objrct sent in the channel."}),"\n",(0,s.jsx)(n.h2,{id:"identifying-servers",children:"Identifying Servers"}),"\n",(0,s.jsx)(n.p,{children:"Identifying servers themselves is tricky, on intial design, i wrote servers with server Ids. This was a fairly simple oversight based om the intial structure i was creating."}),"\n",(0,s.jsx)(n.p,{children:"We should adjust the model(s) to be agent based. This means the agent is assigned an ID, and this is then used to refer to both the server and agent, as from an operation POV, they are one and the same."}),"\n",(0,s.jsx)(n.h2,{id:"communication",children:"Communication"}),"\n",(0,s.jsx)(n.p,{children:"Communication between the Server and the agent's is done via a pub/sub protocol, NATS performed over websockets (port 443)"}),"\n",(0,s.jsx)(n.p,{children:"Data transmitted via JSON."}),"\n",(0,s.jsx)(n.p,{children:"The agents will send periodic heartbeats to the server, with minimal data. This heartbeat will confirm server status, and if there are any pending jobs,\nwill set them off to run."}),"\n",(0,s.jsx)(n.p,{children:"Upon job completion/end, the agent will inform the server of the result of the task, and send relevant data back."}),"\n",(0,s.jsx)(n.h3,{id:"event-log",children:"Event Log"}),"\n",(0,s.jsxs)(n.p,{children:["Events are sent to server from agents, published via the ",(0,s.jsx)(n.code,{children:"nammu-eventlog"})," channel.\nThis is done hourly, and can also be requested with specific queries via the UI panel(s) (TODO)"]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var s=t(7294);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);